# $Id: makefile.in,v 1.1 1994/06/12 23:39:16 tom Exp $
# Makefile-template for 'diffstat'

#### Start of system configuration section. ####

srcdir = @srcdir@
VPATH  = @srcdir@

CC		= @CC@
LINK		= $(CC)
INSTALL		= @INSTALL@
INSTALL_PROGRAM	= @INSTALL_PROGRAM@
INSTALL_DATA	= @INSTALL_DATA@

LIBS		= @LIBS@

prefix		= /usr/local
exec_prefix	= $(prefix)

bindir		= $(exec_prefix)/bin
libdir		= $(exec_prefix)/lib
mandir		= $(prefix)/man/man1
manext		= 1

#### End of system configuration section. ####

SHELL		= /bin/sh

CPPFLAGS	= -I. -I$(srcdir) -DHAVE_CONFIG_H

LDFLAGS		= 

# Tom's preferred flags
CFLAGS		= -O -Wall -Wshadow -Wconversion -Wstrict-prototypes -Wmissing-prototypes

# Flags for distribution; comment out above line and uncomment line below
#CFLAGS		= -O

.c.o:
	$(CC) -c $(CPPFLAGS) $(CFLAGS) $(X_CFLAGS) $<

ALLTOOLS = configure config_h.in \
	install.sh mkinstalldirs \
	configure.in

# miscellaneous text files
TEXTFILES = README

ALLSRC = $(VILESRC) $(SCREENS) $(OTHERSRC) $(HDRS)

DISTFILES = $(ALLTOOLS) $(ALLSRC) $(TEXTFILES)

SRC = $(THIS).c $(THIS).1

OBJ = $(THIS).o

all:	$(THIS)

$(THIS): $(OBJ)
	-mv $(THIS) o$(THIS)
	$(LINK) $(LDFLAGS) -o $(THIS) $(OBJ) $(LIBS)

install: all installdirs
	$(INSTALL_PROGRAM) $(THIS) $(bindir)/$(THIS)
	$(INSTALL_DATA) $(srcdir)/$(THIS).1 $(mandir)/$(THIS).$(manext)

installdirs:
	$(SHELL) ${srcdir}/mkinstalldirs $(bindir) $(libdir) $(mandir)

uninstall:
	rm -f $(bindir)/$(THIS) $(mandir)/$(THIS).$(manext)

makefile: makefile.in config.status
	./config.status

config.status: configure
	./config.status --recheck

mostlyclean:
	rm -f *.o o$(THIS) $(BUILTHDRS) $(MKTBLS) core *~ *.BAK

clean: mostlyclean
	rm -f $(THIS) manfilt

distclean: clean
	rm -f makefile config.status config.h

realclean: distclean
	rm -f tags TAGS

tags:
	ctags $(SRC) $(HDRS)

TAGS:
	etags $(SRC) $(HDRS)

dist:	makefile $(DISTFILES)
	echo vile-`sed -e '/char version/!d' -e 's/.*"version \(.*\)".*/\1/' -e q $(srcdir)/edef.h` > .fname
	rm -rf `cat .fname`
	mkdir `cat .fname`
	for file in $(DISTFILES); do \
	  ln $(srcdir)/$$file `cat .fname` \
	    || { echo copying $$file instead; cp -p $$file `cat .fname`; }; \
	done
	tar -cf - `cat .fname` | gzip >`cat .fname`.tar.gz
	rm -rf `cat .fname` .fname

$(THIS).o:	config.h
